{"ast":null,"code":"'use strict';\n\nconst MongoNetworkError = require('./core').MongoNetworkError;\n\nconst mongoErrorContextSymbol = require('./core').mongoErrorContextSymbol;\n\nconst GET_MORE_NON_RESUMABLE_CODES = new Set([136, // CappedPositionLost\n237, // CursorKilled\n11601 // Interrupted\n]); // From spec@https://github.com/mongodb/specifications/blob/7a2e93d85935ee4b1046a8d2ad3514c657dc74fa/source/change-streams/change-streams.rst#resumable-error:\n//\n// An error is considered resumable if it meets any of the following criteria:\n// - any error encountered which is not a server error (e.g. a timeout error or network error)\n// - any server error response from a getMore command excluding those containing the error label\n//   NonRetryableChangeStreamError and those containing the following error codes:\n//   - Interrupted: 11601\n//   - CappedPositionLost: 136\n//   - CursorKilled: 237\n//\n// An error on an aggregate command is not a resumable error. Only errors on a getMore command may be considered resumable errors.\n\nfunction isGetMoreError(error) {\n  if (error[mongoErrorContextSymbol]) {\n    return error[mongoErrorContextSymbol].isGetMore;\n  }\n}\n\nfunction isResumableError(error) {\n  if (!isGetMoreError(error)) {\n    return false;\n  }\n\n  if (error instanceof MongoNetworkError) {\n    return true;\n  }\n\n  return !(GET_MORE_NON_RESUMABLE_CODES.has(error.code) || error.hasErrorLabel('NonRetryableChangeStreamError'));\n}\n\nmodule.exports = {\n  GET_MORE_NON_RESUMABLE_CODES,\n  isResumableError\n};","map":{"version":3,"sources":["/home/rgukt/Projects/covid-19/node_modules/mongodb/lib/error.js"],"names":["MongoNetworkError","require","mongoErrorContextSymbol","GET_MORE_NON_RESUMABLE_CODES","Set","isGetMoreError","error","isGetMore","isResumableError","has","code","hasErrorLabel","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,iBAAiB,GAAGC,OAAO,CAAC,QAAD,CAAP,CAAkBD,iBAA5C;;AACA,MAAME,uBAAuB,GAAGD,OAAO,CAAC,QAAD,CAAP,CAAkBC,uBAAlD;;AAEA,MAAMC,4BAA4B,GAAG,IAAIC,GAAJ,CAAQ,CAC3C,GAD2C,EACtC;AACL,GAF2C,EAEtC;AACL,KAH2C,CAGrC;AAHqC,CAAR,CAArC,C,CAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASC,cAAT,CAAwBC,KAAxB,EAA+B;AAC7B,MAAIA,KAAK,CAACJ,uBAAD,CAAT,EAAoC;AAClC,WAAOI,KAAK,CAACJ,uBAAD,CAAL,CAA+BK,SAAtC;AACD;AACF;;AAED,SAASC,gBAAT,CAA0BF,KAA1B,EAAiC;AAC/B,MAAI,CAACD,cAAc,CAACC,KAAD,CAAnB,EAA4B;AAC1B,WAAO,KAAP;AACD;;AAED,MAAIA,KAAK,YAAYN,iBAArB,EAAwC;AACtC,WAAO,IAAP;AACD;;AAED,SAAO,EACLG,4BAA4B,CAACM,GAA7B,CAAiCH,KAAK,CAACI,IAAvC,KACAJ,KAAK,CAACK,aAAN,CAAoB,+BAApB,CAFK,CAAP;AAID;;AAEDC,MAAM,CAACC,OAAP,GAAiB;AAAEV,EAAAA,4BAAF;AAAgCK,EAAAA;AAAhC,CAAjB","sourcesContent":["'use strict';\n\nconst MongoNetworkError = require('./core').MongoNetworkError;\nconst mongoErrorContextSymbol = require('./core').mongoErrorContextSymbol;\n\nconst GET_MORE_NON_RESUMABLE_CODES = new Set([\n  136, // CappedPositionLost\n  237, // CursorKilled\n  11601 // Interrupted\n]);\n\n// From spec@https://github.com/mongodb/specifications/blob/7a2e93d85935ee4b1046a8d2ad3514c657dc74fa/source/change-streams/change-streams.rst#resumable-error:\n//\n// An error is considered resumable if it meets any of the following criteria:\n// - any error encountered which is not a server error (e.g. a timeout error or network error)\n// - any server error response from a getMore command excluding those containing the error label\n//   NonRetryableChangeStreamError and those containing the following error codes:\n//   - Interrupted: 11601\n//   - CappedPositionLost: 136\n//   - CursorKilled: 237\n//\n// An error on an aggregate command is not a resumable error. Only errors on a getMore command may be considered resumable errors.\n\nfunction isGetMoreError(error) {\n  if (error[mongoErrorContextSymbol]) {\n    return error[mongoErrorContextSymbol].isGetMore;\n  }\n}\n\nfunction isResumableError(error) {\n  if (!isGetMoreError(error)) {\n    return false;\n  }\n\n  if (error instanceof MongoNetworkError) {\n    return true;\n  }\n\n  return !(\n    GET_MORE_NON_RESUMABLE_CODES.has(error.code) ||\n    error.hasErrorLabel('NonRetryableChangeStreamError')\n  );\n}\n\nmodule.exports = { GET_MORE_NON_RESUMABLE_CODES, isResumableError };\n"]},"metadata":{},"sourceType":"script"}